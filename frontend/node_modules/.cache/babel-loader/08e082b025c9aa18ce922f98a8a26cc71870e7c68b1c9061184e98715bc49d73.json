{"ast":null,"code":"import'../App.css';import React,{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import logohide from\"../components/hide.png\";import logoshow from\"../components/show.png\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=_ref=>{let{setIsAuthenticated}=_ref;const navigate=useNavigate();const[username,setUsername]=useState(\"\");const[password,setPassword]=useState(\"\");const[showPassword,setShowPassword]=useState(false);const[error,setError]=useState(\"\");const loginclick=async e=>{e.preventDefault();setError(\"\");try{const response=await fetch(\"http://localhost:5000/login\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({username,password})});const data=await response.json();if(!response.ok){throw new Error(data.error||\"Login failed\");}localStorage.setItem(\"token\",data.token);localStorage.setItem(\"role\",data.role);// ✅ บันทึก role\nsetIsAuthenticated(true);// ✅ อัปเดต isAuthenticated\nnavigate(data.role===\"Dev\"||data.role===\"Admin\"?\"/homeAdmin\":\"/home\",{replace:true});}catch(err){setError(err.message);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"login-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-section\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"WELCOME TO\"}),/*#__PURE__*/_jsx(\"h1\",{style:{marginTop:'410px'},children:\"ICE CREAM\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"FREEZER\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"login-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"LOGIN\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-text\",style:{color:'red'},children:error}),/*#__PURE__*/_jsxs(\"form\",{className:\"login-form\",onSubmit:loginclick,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:username,onChange:e=>setUsername(e.target.value),required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:showPassword?'text':'password',value:password,onChange:e=>setPassword(e.target.value),required:true}),/*#__PURE__*/_jsx(\"img\",{src:showPassword?logoshow:logohide,style:{width:'15px',marginTop:'-30px',marginLeft:'360px',cursor:'pointer'},alt:showPassword?'Hide password':'Show password',onClick:()=>setShowPassword(!showPassword)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",style:{fontWeight:'lighter'},children:\"Login\"})]})]})]});};export default Login;","map":{"version":3,"names":["React","useState","useNavigate","logohide","logoshow","jsx","_jsx","jsxs","_jsxs","Login","_ref","setIsAuthenticated","navigate","username","setUsername","password","setPassword","showPassword","setShowPassword","error","setError","loginclick","e","preventDefault","response","fetch","method","headers","body","JSON","stringify","data","json","ok","Error","localStorage","setItem","token","role","replace","err","message","className","children","style","marginTop","color","onSubmit","htmlFor","type","value","onChange","target","required","src","width","marginLeft","cursor","alt","onClick","fontWeight"],"sources":["C:/Users/Ratti/WebDetectionIcecream/frontend/src/pages/login.js"],"sourcesContent":["import '../App.css';\r\nimport React, { useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport logohide from \"../components/hide.png\";\r\nimport logoshow from \"../components/show.png\";\r\n\r\nconst Login = ({ setIsAuthenticated }) => {\r\n    const navigate = useNavigate();\r\n    const [username, setUsername] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [showPassword, setShowPassword] = useState(false);\r\n    const [error, setError] = useState(\"\");\r\n\r\n    const loginclick = async (e) => {\r\n        e.preventDefault();\r\n        setError(\"\");\r\n        try {\r\n            const response = await fetch(\"http://localhost:5000/login\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify({ username, password })\r\n            });\r\n            const data = await response.json();\r\n\r\n            if (!response.ok) {\r\n                throw new Error(data.error || \"Login failed\");\r\n            }\r\n\r\n            localStorage.setItem(\"token\", data.token);\r\n            localStorage.setItem(\"role\", data.role);  // ✅ บันทึก role\r\n            setIsAuthenticated(true);  // ✅ อัปเดต isAuthenticated\r\n            navigate(data.role === \"Dev\" || data.role === \"Admin\" ? \"/homeAdmin\" : \"/home\", { replace: true });\r\n\r\n        } catch (err) {\r\n            setError(err.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"login-container\">\r\n            <div className=\"welcome-section\">\r\n                <h1>WELCOME TO</h1>\r\n                <h1 style={{ marginTop: '410px' }}>ICE CREAM</h1>\r\n                <h1>FREEZER</h1>\r\n            </div>\r\n            <div className=\"login-section\">\r\n                <h2>LOGIN</h2>\r\n                {error && <p className=\"error-text\" style={{ color: 'red' }}>{error}</p>}\r\n                <form className=\"login-form\" onSubmit={loginclick}>\r\n                    <label htmlFor=\"username\">Username</label>\r\n                    <input type=\"text\" value={username} onChange={(e) => setUsername(e.target.value)} required />\r\n                    <label htmlFor=\"password\">Password</label>\r\n                    <input type={showPassword ? 'text' : 'password'} value={password} onChange={(e) => setPassword(e.target.value)} required />\r\n                    <img src={showPassword ? logoshow : logohide}\r\n                        style={{ width: '15px', marginTop: '-30px', marginLeft: '360px', cursor: 'pointer' }}\r\n                        alt={showPassword ? 'Hide password' : 'Show password'}\r\n                        onClick={() => setShowPassword(!showPassword)}\r\n                    />\r\n                    <button type=\"submit\" style={{ fontWeight: 'lighter'}}>\r\n                        Login\r\n                    </button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}