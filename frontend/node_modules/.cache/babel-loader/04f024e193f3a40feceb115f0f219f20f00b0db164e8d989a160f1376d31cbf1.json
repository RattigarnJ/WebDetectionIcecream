{"ast":null,"code":"import'./App.css';import Navbar from'./components/Navbar';import{HashRouter as Router,Routes,Route,Navigate,useLocation}from\"react-router-dom\";import{useEffect,useState}from\"react\";import Pull from'./pages/pull';import Home from'./pages/home';import Show from'./pages/show';import Login from'./pages/login';import ShowST from'./pages/showst';import ShowLD from'./pages/showld';import PullST from'./pages/pullst';import PullLD from'./pages/pullld';import ShowReport from'./pages/showreport';import PullSuc from'./pages/pullsuccess';import HomeAdmin from'./pages/homeadmin';import Signin from'./pages/register';import Member from'./pages/member';import Pullwait from'./pages/pullwaiting';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function PrivateRoute(_ref){let{children,allowedRoles}=_ref;const token=localStorage.getItem(\"token\");const role=localStorage.getItem(\"role\");if(!token||!allowedRoles.includes(role)){return/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true});}return children;}function App(){const[isAuthenticated,setIsAuthenticated]=useState(!!localStorage.getItem(\"token\"));useEffect(()=>{const checkAuth=()=>setIsAuthenticated(!!localStorage.getItem(\"token\"));window.addEventListener(\"storage\",checkAuth);return()=>window.removeEventListener(\"storage\",checkAuth);},[]);function LayoutWithNavbar(_ref2){let{children}=_ref2;const location=useLocation();const showNavbar=isAuthenticated&&location.pathname!==\"/\";return/*#__PURE__*/_jsxs(_Fragment,{children:[showNavbar&&/*#__PURE__*/_jsx(Navbar,{setIsAuthenticated:setIsAuthenticated}),children]});}return/*#__PURE__*/_jsx(\"div\",{className:\"Containner\",children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(LayoutWithNavbar,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Login,{setIsAuthenticated:setIsAuthenticated})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:isAuthenticated?/*#__PURE__*/_jsx(Navigate,{to:localStorage.getItem(\"role\")===\"Dev\"||localStorage.getItem(\"role\")===\"Admin\"?\"/homeAdmin\":\"/home\",replace:true}):/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\"],children:/*#__PURE__*/_jsx(Signin,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/member\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\"],children:/*#__PURE__*/_jsx(Member,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/home\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"User\"],children:/*#__PURE__*/_jsx(Home,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/homeAdmin\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"Admin\"],children:/*#__PURE__*/_jsx(HomeAdmin,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/pull\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"Admin\",\"User\"],children:/*#__PURE__*/_jsx(Pull,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/show\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"Admin\",\"User\"],children:/*#__PURE__*/_jsx(Show,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/showst\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"Admin\",\"User\"],children:/*#__PURE__*/_jsx(ShowST,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/showld\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"Admin\",\"User\"],children:/*#__PURE__*/_jsx(ShowLD,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/pullst\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"Admin\",\"User\"],children:/*#__PURE__*/_jsx(PullST,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/pullld\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"Admin\",\"User\"],children:/*#__PURE__*/_jsx(PullLD,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/showreport\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"Admin\",\"User\"],children:/*#__PURE__*/_jsx(ShowReport,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/pullsuccess\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"Admin\",\"User\"],children:/*#__PURE__*/_jsx(PullSuc,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/pullwaiting\",element:/*#__PURE__*/_jsx(PrivateRoute,{allowedRoles:[\"Dev\",\"Admin\"],children:/*#__PURE__*/_jsx(Pullwait,{})})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})})]})})})});}export default App;","map":{"version":3,"names":["Navbar","HashRouter","Router","Routes","Route","Navigate","useLocation","useEffect","useState","Pull","Home","Show","Login","ShowST","ShowLD","PullST","PullLD","ShowReport","PullSuc","HomeAdmin","Signin","Member","Pullwait","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","PrivateRoute","_ref","children","allowedRoles","token","localStorage","getItem","role","includes","to","replace","App","isAuthenticated","setIsAuthenticated","checkAuth","window","addEventListener","removeEventListener","LayoutWithNavbar","_ref2","location","showNavbar","pathname","className","path","element"],"sources":["C:/Users/Ratti/WebDetectionIcecream/frontend/src/App.js"],"sourcesContent":["import './App.css';\nimport Navbar from './components/Navbar';\nimport { HashRouter as Router, Routes, Route, Navigate, useLocation } from \"react-router-dom\";\nimport { useEffect, useState } from \"react\";\nimport Pull from './pages/pull'\nimport Home from './pages/home'\nimport Show from './pages/show'\nimport Login from './pages/login'\nimport ShowST from './pages/showst'\nimport ShowLD from './pages/showld'\nimport PullST from './pages/pullst'\nimport PullLD from './pages/pullld'\nimport ShowReport from './pages/showreport'\nimport PullSuc from './pages/pullsuccess'\nimport HomeAdmin from './pages/homeadmin'\nimport Signin from './pages/register'\nimport Member from './pages/member'\nimport Pullwait from './pages/pullwaiting'\n\nfunction PrivateRoute({ children, allowedRoles }) {\n  const token = localStorage.getItem(\"token\");\n  const role = localStorage.getItem(\"role\");\n\n  if (!token || !allowedRoles.includes(role)) {\n    return <Navigate to=\"/\" replace />;\n  }\n  return children;\n}\n\nfunction App() {\n\n  const [isAuthenticated, setIsAuthenticated] = useState(!!localStorage.getItem(\"token\"));\n\n  useEffect(() => {\n    const checkAuth = () => setIsAuthenticated(!!localStorage.getItem(\"token\"));\n    window.addEventListener(\"storage\", checkAuth);\n    return () => window.removeEventListener(\"storage\", checkAuth);\n  }, []);\n\n  function LayoutWithNavbar({ children }) {\n    const location = useLocation();\n    const showNavbar = isAuthenticated && location.pathname !== \"/\";\n    return (\n      <>\n        {showNavbar && <Navbar setIsAuthenticated={setIsAuthenticated} />}\n        {children}\n      </>\n    );\n  }\n\n  return (\n    <div className=\"Containner\">\n      <Router>\n        <LayoutWithNavbar>\n          <Routes>\n            {/* หน้า Login เป็นหน้าเริ่มต้น */}\n            <Route \n              path=\"/\" \n              element={<Login setIsAuthenticated={setIsAuthenticated} />} \n            />\n            {/* Redirect ไปหน้าหลักหลัง login */}\n            <Route \n              path=\"/dashboard\" \n              element={\n                isAuthenticated \n                  ? <Navigate to={localStorage.getItem(\"role\") === \"Dev\" || localStorage.getItem(\"role\") === \"Admin\" ? \"/homeAdmin\" : \"/home\"} replace /> \n                  : <Navigate to=\"/\" replace />\n              } \n            />\n            <Route path=\"/register\" element={<PrivateRoute allowedRoles={[\"Dev\"]}><Signin /></PrivateRoute>} />\n            <Route path=\"/member\" element={<PrivateRoute allowedRoles={[\"Dev\"]}><Member /></PrivateRoute>} />\n            <Route path=\"/home\" element={<PrivateRoute allowedRoles={[\"Dev\", \"User\"]}><Home /></PrivateRoute>} />\n            <Route path=\"/homeAdmin\" element={<PrivateRoute allowedRoles={[\"Dev\", \"Admin\"]}><HomeAdmin /></PrivateRoute>} />\n            <Route path=\"/pull\" element={<PrivateRoute allowedRoles={[\"Dev\", \"Admin\", \"User\"]}><Pull /></PrivateRoute>} />\n            <Route path=\"/show\" element={<PrivateRoute allowedRoles={[\"Dev\", \"Admin\", \"User\"]}><Show /></PrivateRoute>} />\n            <Route path=\"/showst\" element={<PrivateRoute allowedRoles={[\"Dev\", \"Admin\", \"User\"]}><ShowST /></PrivateRoute>} />\n            <Route path=\"/showld\" element={<PrivateRoute allowedRoles={[\"Dev\", \"Admin\", \"User\"]}><ShowLD /></PrivateRoute>} />\n            <Route path=\"/pullst\" element={<PrivateRoute allowedRoles={[\"Dev\", \"Admin\", \"User\"]}><PullST /></PrivateRoute>} />\n            <Route path=\"/pullld\" element={<PrivateRoute allowedRoles={[\"Dev\", \"Admin\", \"User\"]}><PullLD /></PrivateRoute>} />\n            <Route path=\"/showreport\" element={<PrivateRoute allowedRoles={[\"Dev\", \"Admin\", \"User\"]}><ShowReport /></PrivateRoute>} />\n            <Route path=\"/pullsuccess\" element={<PrivateRoute allowedRoles={[\"Dev\", \"Admin\", \"User\"]}><PullSuc /></PrivateRoute>} />\n            <Route path=\"/pullwaiting\" element={<PrivateRoute allowedRoles={[\"Dev\", \"Admin\"]}><Pullwait /></PrivateRoute>}/>\n            <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n          </Routes>\n        </LayoutWithNavbar>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}